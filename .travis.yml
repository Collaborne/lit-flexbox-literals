dist: trusty
group: beta
language: node_js
node_js:
- node
cache:
  directories:
  - node_modules
before_install:
- if [ -d node_modules ] && [ x$(cat node_modules/.last-node-version 2>/dev/null) != x$(node -e 'console.log(process.version)') ]; then npm rebuild --update-binary && node -e 'console.log(process.version)' > node_modules/.last-node-version; fi
before_script:
- npm run build
deploy:
  provider: npm
  email: npm@collaborne.com
  api_key:
    secure: "LyaYCOnFcn/kHdE3vsd44sseTQSQUOIDZmr4uV1EZ5Y0NGQSkMBjF5eqkg8LBicTF5qSpzrm262wU98OC0jc4XvaincYdobkq9p2JGzBCUlHRdGE77DJQM0hkB4kL2EHvgSmCwY4+3Xz5TSO/wHmUL3p2ld5MB+F+QmXeADsGDfRW1TjaPy+zWNTL06gPXiSSbHp9utw2vLA0KXQtUla2wYmyYndfQNeztHvjyUsQbgzuDFuL4l27P7D/NE+H7acB8yQrr6ukyYVfU7Qo1W/flyjw255w4MaBahk+dOfi9s/vVrszpPkeR7Xi3RwrjH/sOqDdYgz18/Rn29s6yTTzy383P29KzT3mFIvsJnk1DurgRDD5U34LqnGlEWgnS4w155WVBfAA3qy7fzZ5e4GwRNqx8dOoLuwUHe3uX/6sgJeYhMaig0/5TJF0vbR6DfbG3avgu2/2dAnEtgusATLcDAKmyZ+hL8tBgUEKA5pYwPedkWPIUQV2c3bv1cMLoHPsyQN5d6+Hy2O1C4SGTU2CicJdf46CUr0rRJ21CAlXeEUKKzQ6tADx9qCmjHIobEYYdamNzbdpJJ55XKAC3plAPJa/TXi2uBemhBLKTWz2DBzZiDqFdS/zvRe8rtbqQ1Xq42qA8l+IHeexhnXaSmSG+ELSo9lWkI4hsjjGE+elA8="
  on:
    tags: true
    condition: $(node -e 'console.log("v" + require("./package.json").version)') = ${TRAVIS_TAG}
  skip_cleanup: true
